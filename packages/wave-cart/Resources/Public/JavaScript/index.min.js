(()=>{var e=new Set(Array.from(document.querySelectorAll(".tile")).map(e=>e.dataset.type)),t=document.getElementById("type-select");if(t){const n=document.createElement("option");n.value="",n.textContent="All Types",t.appendChild(n),e.forEach(e=>{const n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)})}function n(){const e=document.getElementById("size-select");if(e){e.innerHTML="";const t=Array.from(document.querySelectorAll(".tile")).filter(e=>"none"!==e.style.display),n=new Set;t.forEach(e=>{try{JSON.parse(e.dataset.variants||"[]").forEach(e=>n.add(e))}catch(t){console.warn("Invalid size data:",e.dataset.variants)}});const o=document.createElement("option");o.value="",o.textContent="All Sizes",e.appendChild(o),n.forEach(t=>{const n=document.createElement("option");n.value=t,n.textContent=t,e.appendChild(n)})}}n(),t&&t.addEventListener("change",function(){const e=this.value;document.querySelectorAll(".tile").forEach(t=>{const n=t.dataset.type;t.style.display=""===e||n===e?"":"none"}),n()});var o=document.getElementById("sort-select"),a=document.getElementById("tile-container");o&&o.addEventListener("change",function(){const e=Array.from(a.querySelectorAll(".tile"));if("price-asc"===this.value)e.sort((e,t)=>parseFloat(e.dataset.price)-parseFloat(t.dataset.price));else{if("price-desc"!==this.value)return;e.sort((e,t)=>parseFloat(t.dataset.price)-parseFloat(e.dataset.price))}e.forEach(e=>a.appendChild(e))});var c=document.getElementById("size-select");c&&c.addEventListener("change",function(){const e=this.value,n=document.querySelectorAll(".tile"),o=t?t.value:"";n.forEach(e=>{const t=e.dataset.type||"";e.style.display=""===o||t===o?"":"none"}),n.forEach(t=>{const n=JSON.parse(t.dataset.variants||"[]"),o=""===e||n.includes(e);"none"===t.style.display||(t.style.display=o?"":"none")})}),document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".variant-option"),t=document.getElementById("addToCart");e.forEach(n=>{n.addEventListener("click",function(){e.forEach(e=>e.classList.remove("active")),this.classList.contains("sold-out")?t.disabled=!0:(t.disabled=!1,this.classList.add("active"))})}),1===e.length&&(t.disabled=!1,e[0].classList.add("active"))});var s=document.getElementById("addToCart");s&&s.addEventListener("click",()=>{!function(e){const t=r("cartCookie");console.log("cookieData",t);const n=t?JSON.parse(t):[];console.log("ids (parsed)",n),n.includes(e)||(n.push(e),d("cartCookie",JSON.stringify(n)),console.log("Updated cookie:",n))}(parseInt(document.querySelector(".variant-option.active").dataset.id)),r("cartCookie"),document.getElementById("cartModal").style.display="flex"});var l=document.getElementById("closeModal");function r(e){const t=`; ${document.cookie}`.split(`; ${e}=`);return 2===t.length?decodeURIComponent(t.pop().split(";").shift()):null}function d(e,t,n=7){const o=new Date(Date.now()+864e5*n).toUTCString();document.cookie=`${e}=${encodeURIComponent(t)}; expires=${o}; path=/`}function i(e=0){let t=0;document.querySelectorAll(".cart-item").forEach(e=>{const n=e.querySelector(".item-price"),o=e.querySelector(".amount-number"),a=parseFloat(n.dataset.price),c=parseInt(o.value,10)||0;t+=a*c}),0!==e&&e<0&&(t+=e);const n=document.getElementById("discountTotal");n&&(n.textContent=`Discount: ${e.toFixed(2)}â‚¬`);const o=document.getElementById("cartTotal");return o&&(o.textContent=`Total (incl. tax): ${t.toFixed(2)}â‚¬`),o.textContent=`Total (incl. tax): ${t.toFixed(2)}â‚¬`,t}console.log(l),l&&l.addEventListener("click",()=>{document.getElementById("cartModal").style.display="none"}),document.querySelectorAll(".cart-discount-control").forEach(e=>{const t=e.querySelector(".check-discount"),n=e.querySelector(".discount-code"),o=e.querySelector(".hidden-discount-code"),a=e.querySelector(".hidden-discount-value"),c=e.querySelector(".redeem-status");t.addEventListener("click",()=>{try{fetch(`/api/discount?code=${n.value}`).then(async e=>{const t=await e.text(),s=await JSON.parse(t);if(200!==e.status)c.innerText=await s.error,c.classList.remove("redeem-status-success"),c.classList.add("redeem-status-error");else{const e=await s.type,t=await s.discount;if("relative"===e){const e=-i()*(t/100);a.value=e,i(e)}else{const e=-t;a.value=e,i(e)}c.classList.remove("redeem-status-error"),c.classList.add("redeem-status-success"),o.value=n.value,n.value="",c.innerText="Discount coupon added!"}})}catch(e){c.innerText=e.message}})}),document.querySelectorAll(".amount-control").forEach(e=>{e.dataset.index;const t=e.querySelector(".decrease-btn"),n=e.querySelector(".increase-btn"),o=e.querySelector(".amount-number");function a(e,t){e.textContent=1===t?"ðŸ—‘":"Â Â Â -"}t&&(t.addEventListener("click",()=>{let n=parseInt(o.value,10)||0;1===n?(function(e){const t=r("cartCookie"),n=(t?JSON.parse(t):[]).filter(t=>t!==e);d("cartCookie",JSON.stringify(n)),console.log("Removed ID, updated cookie:",n)}(parseInt(e.closest(".cart-item").dataset.id)),e.closest(".cart-item").remove()):n>1&&(n--,o.value=n,a(t,n)),i()}),a(t,parseInt(o.value,10)||0)),n&&n.addEventListener("click",()=>{let e=parseInt(o.value,10)||0;e++,o.value=e,a(t,e),i()})}),i()})();